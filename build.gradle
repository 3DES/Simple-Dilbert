apply plugin: 'android'

buildscript {
	repositories {
		mavenCentral()
	}
	dependencies {
		classpath 'com.android.tools.build:gradle:0.5.6'
	}
}

repositories {
	mavenCentral()
}

dependencies {
	compile 'com.android.support:support-v4:18.0.+'
	compile 'com.actionbarsherlock:actionbarsherlock:4.4.0@aar'
	compile 'joda-time:joda-time:2.3'
	compile 'org.joda:joda-convert:1.4'
	compile 'com.nostra13.universalimageloader:universal-image-loader:1.8.6'
	compile files(':libraries/PhotoView-42ee0befb41f916de37344e667582a7cec00d933.jar')
	compile project(':libraries:FileExplorer')
}

android {
	compileSdkVersion 18
	buildToolsVersion "18.0.1"

	signingConfigs {
		release {
			storeFile = file('android.keystore')
			keyAlias = "simple_dilbert"
		}
	}

	buildTypes {
		release {
			signingConfig signingConfigs.release
		}
	}

	sourceSets {
		main {
			manifest.srcFile 'AndroidManifest.xml'
			java.srcDirs = ['src']
			resources.srcDirs = ['src']
			aidl.srcDirs = ['src']
			renderscript.srcDirs = ['src']
			res.srcDirs = ['res']
			assets.srcDirs = ['assets']
		}
	}

	defaultConfig {
		minSdkVersion 8
		targetSdkVersion 18
	}
}

task readPasswordFromInput << {
	def newKeyStore = System.console().readLine("\nEnter keystore location or enter (default: android.keystore): ")
	if(newKeyStore != '') android.singingConfigs.release.storeFile = file('${newKeyStore}')
	android.signingConfigs.release.storePassword = new String(System.console().readPassword("\$ Store password: "))
        android.signingConfigs.release.keyPassword = new String(System.console().readPassword("\$ Key password: "))
}

tasks.whenTaskAdded { task ->
    if (task.name == 'validateReleaseSigning') {
        task.dependsOn readPasswordFromInput
    }
}
